![image](https://github.com/user-attachments/assets/2c9d012a-7012-4961-a458-6a7b2767ef95)# E-Detect：Multimodal-assisted-monitoring-system-for-the-elderly

codes are in master branch.

根据中国国家统计局政府信息公开显示，截止至2022年末,全国60岁以上老龄人口为28004万人，占总人口数的19.8%，如图1所示。由此可见，中国的老龄化问题十分严峻。而与之相反的是，我国目前仅有养老服务机构和设施35.7万个，养老服务床位813.5万张，仅按照国家标准养老护理员与老年人的比例为1∶4计算，至少需要养老护理员200余万名。然而，我国目前养老护理员仅有32.2万名，缺口达到近170万。

我们当然希望老年人能24小时获得实时的监护，有异常能得到及时的反馈，但事实上受限于人力物力，这样美好的愿景仍未能实现。倘若有一双眼睛能不知疲倦地实时监视老人的行为，敏锐地捕捉到异常状况，并及时提醒护工，甚至将这些数据整合统计，以供医护人员进一步的分析与调整，那么这样的愿望便能有希望成为现实。我们团队便想做出这样的一双“慧眼”——即设计出一套针对失能与半失能老年人的多模态辅助监护系统。


![image](https://github.com/user-attachments/assets/cf79a9e5-1c5b-4f20-b00a-8237975f1f53)
总设计图

### 基于AlphaPose，Xception，ECAPA-tdnn的多模态检测器

本团队成功实现并整合了三项技术，分别涉及人体异常动作识别、异常表情识别及异常环境检测系统。其中，人体异常动作识别利用了最新的AlphaPose模型，有效捕捉并分析人体非正常动态；异常表情识别系统则基于深入的表情特征学习算法，旨在及时发现异常人脸表情；而异常环境检测系统依托ECAPA-TDNN模型，可精准探测环境中潜在的不安全因素。

项目主要采用了卷积神经网络（XCEPTION）来搭建识别系统，经过训练得到了人脸识别及表情识别模型，具有较好的表情识别效果。最终，表情识别系统可以实现三种不同的识别模式，分别为单独表情识别，表情与性别识别和人脸特征梯度化。

当前模型的训练主要基于一些公开的数据集进行，且主要训练数据多为中青年表情，对于老年人的表情数据训练较少，可能不能很好的识别老年人表情。之后，团队将会通过虚幻引擎生成老人表情数据，加强模型对老年人数据集的生成和训练，增强其对老年人表情的识别。

异常动作识别是系统的第二大模块，我们采用了AlphaPose人体姿态提取模型来检测人体动作，通过将人体的头，左右耳，手臂关节，腿部关节以及手，脚等作为人体姿态特征点，通过这些特征点的定位和连线来确定人体姿态。

除了姿态提取模型外，我们还训练了动作预测模型，动作追踪模型等来辅助检测，使得系统能够精确识别预测出老年人跌倒等异常动作。为了保证识别精度，我们对单个人体识别时都添加了两个人体姿态检测框，在人体姿态检测框的基础上训练了老年人跌倒检测等异常姿态检测模型。当两个检测框都显示老人跌倒，则向用户发出警报。

目前检测器三个模态平均准确率为78.3%

--- 

检测器端主要功能(OHD_Project_Detector)
- 检测异常情况
- 将异常情况写入数据库
- 定期清空数据库
- 将Java端写入的新增检测器添加并运行
- 删除检测器


### 前后端管理系统

Java端(OHD_Project_Manager)
- 用户注册登陆，查看修改个人信息
- 护工注册登陆登出，查看修改个人信息
- 添加相关房间信息，小组信息
- 设定日志存储位置并定期生成日志
- 显示在线护工列表
- 显示当前消息列表
  
- 查询数据库触发报警(小于5s内出现同位置，同类别异常记录>=10条，判定为异常状态)
- 语音报警，控制台打印报警信息(基于jacbo工具合成语音)
- 插入报警记录(包括长期和短期记录)
- 添加删除检测器

---


![image](https://github.com/user-attachments/assets/f5f5f720-f503-49c0-9153-d418d0d57e60)
注册界面


![image](https://github.com/user-attachments/assets/85d2e67a-d2ac-481d-97a5-92eb1b000fae)
登录界面

![image](https://github.com/user-attachments/assets/a57d0b56-3a73-411b-a1e3-fb26e669e26f)
用户主面板（左侧为在线护工，右侧为异常记录消息栏


![image](https://github.com/user-attachments/assets/ee54e46e-935a-4233-bc48-003145d6e8c5)
功能分别为：查看个人信息，添加删除检测器，可视化数据查看，设置日志保存位置

![image](https://github.com/user-attachments/assets/95e7606e-b0c7-442a-ba33-22c46b088857)
用户个人信息查看

![image](https://github.com/user-attachments/assets/e6d68099-c367-488b-a2cf-64c8c1e5d625)
生成异常记录日志


### 实地检测

测试场地和测试记录：

![image](https://github.com/user-attachments/assets/4f84bfda-a03c-4d2f-9c41-ba6afce684ea)

![image](https://github.com/user-attachments/assets/3989ebf9-0260-4543-a4a0-3f84ab00a39d)


